#include <stddef.h>

#include "wasm_export.h"
{%- for include in includes %}
#include "{{ include }}"
{%- endfor %}

void wasm_libs_set_wasm_module_inst(wasm_module_inst_t module_inst);
{%- for library in libraries.values() %}
int wasm_libs_register_{{ library.name }}_natives(const char* env);
{%- endfor %}

// forward declarations so that functions are well declared even if defined in user code
{%- for library in libraries.values() -%}
    {%- for function in library.functions.values() %}
{{ function.return_type }} {{ function.original_name }}(
        {%- for parameter in function.parameters.values() -%}
            {%- if parameter.is_function_handle() -%}
    {{ library.function_handles[parameter.type].return_type }} (*{{ parameter.name }})(
                {%- if library.function_handles[parameter.type].parameters|length == 0 -%}void{%- endif -%}
                {%- for parameter2 in library.function_handles[parameter.type].parameters.values() -%}
       {{ parameter2.type }} {{ parameter2.name }}{%- if not loop.last %}, {% endif -%}
                {%- endfor -%}
    )
            {%- else -%}
    {{ parameter.type }} {{ parameter.name }}
            {%- endif -%}
            {%- if not loop.last %}, {% endif -%}
        {%- endfor -%}
);
    {%- endfor -%}
{%- endfor -%}